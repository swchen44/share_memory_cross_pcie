sequenceDiagram
    participant EMIWriter
    participant DRAMBuffer
    participant PCIEHost

    EMIWriter->>DRAMBuffer: Initialize DRAM buffer
    loop More data
        EMIWriter->>DRAMBuffer: Write data
        DRAMBuffer-->>EMIWriter: Update write pointer
        EMIWriter->>PCIEHost: Send MSI interrupt
        PCIEHost-->>EMIWriter: Receive CCIF interrupt
    end
